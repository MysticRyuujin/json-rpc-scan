# shellcheck shell=bash
# direnv configuration for json-rpc-scan
# See: https://direnv.net/

# Use pyenv for Python version management
if has pyenv; then
    layout pyenv 3.13
fi

# Use uv for virtual environment
if has uv; then
    # Create venv if it doesn't exist
    if [[ ! -d .venv ]]; then
        log_status "Creating virtual environment with uv..."
        uv venv --python 3.13
    fi

    # Activate the virtual environment
    # shellcheck source=/dev/null
    source .venv/bin/activate

    # Sync dependencies if pyproject.toml changed
    watch_file pyproject.toml
    watch_file uv.lock
fi

# Project-specific environment variables
export PYTHONDONTWRITEBYTECODE=1
export PYTHONUNBUFFERED=1

# Optional: Load local .env file if it exists
dotenv_if_exists .env
